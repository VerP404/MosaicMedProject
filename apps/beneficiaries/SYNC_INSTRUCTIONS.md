# üîÑ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## –ü—Ä–æ–±–ª–µ–º–∞ –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞

**–û—à–∏–±–∫–∞:** `django.db.utils.DataError: value too long for type character varying(255)`

**–ü—Ä–∏—á–∏–Ω–∞:** –í —Ç–∞–±–ª–∏—Ü–µ `Recipe` –µ—Å—Ç—å –∑–∞–ø–∏—Å–∏ —Å –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ (–±–æ–ª–µ–µ 255 —Å–∏–º–≤–æ–ª–æ–≤), –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤ –ø–æ–ª–µ `name` –º–æ–¥–µ–ª–∏ `Drug`.

**–†–µ—à–µ–Ω–∏–µ:** –ö–æ–º–∞–Ω–¥–∞ `sync_from_recipes` —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–µ–∑–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –≤—ã–≤–æ–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è.

---

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd ~/code/MosaicMedProject

# –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è git)
git pull

# –ò–ª–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –≤—Ä—É—á–Ω—É—é
# –§–∞–π–ª: apps/beneficiaries/management/commands/sync_from_recipes.py
```

### –®–∞–≥ 2: –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

```bash
source .venv/bin/activate
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –∫–æ–º–∞–Ω–¥—ã (—Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º)

```bash
# –¢–µ—Å—Ç —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –Ω–∞ 100 —Ä–µ—Ü–µ–ø—Ç–æ–≤
python manage.py sync_from_recipes --limit 100 --dry-run
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç —á—Ç–æ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω–æ, –Ω–æ –Ω–µ –≤–Ω–µ—Å—ë—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ë–î.

### –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

```bash
# –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö 26259 —Ä–µ—Ü–µ–ø—Ç–æ–≤
python manage.py sync_from_recipes

# –ò–ª–∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ, —á–∞—Å—Ç—è–º–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞)
python manage.py sync_from_recipes --limit 5000
python manage.py sync_from_recipes --limit 10000
# –∏ —Ç.–¥.
```

---

## üîç –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–º–∞–Ω–¥–µ

1. **–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `safe_truncate()`**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–µ–∑–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
   - –î–æ–±–∞–≤–ª—è–µ—Ç "..." –≤ –∫–æ–Ω–µ—Ü –æ–±—Ä–µ–∑–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–ª–∞–≥, –±—ã–ª –ª–∏ –æ–±—Ä–µ–∑–∞–Ω —Ç–µ–∫—Å—Ç

2. **–û–±–Ω–æ–≤–ª—ë–Ω –º–µ—Ç–æ–¥ `sync_drugs()`**
   - –û–±—Ä–µ–∑–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ –¥–æ 255 —Å–∏–º–≤–æ–ª–æ–≤
   - –û–±—Ä–µ–∑–∞–µ—Ç –ú–ù–ù –¥–æ 255 —Å–∏–º–≤–æ–ª–æ–≤
   - –û–±—Ä–µ–∑–∞–µ—Ç –∫–æ–¥—ã –¥–æ 50 —Å–∏–º–≤–æ–ª–æ–≤
   - –í—ã–≤–æ–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –æ–±—Ä–µ–∑–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–µ—Ä–≤—ã–µ 3 –ø—Ä–∏–º–µ—Ä–∞ –æ–±—Ä–µ–∑–∞–Ω–Ω—ã—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤

3. **–û–±–Ω–æ–≤–ª—ë–Ω –º–µ—Ç–æ–¥ `sync_patients()`**
   - –û–±—Ä–µ–∑–∞–µ—Ç –§–ò–û –¥–æ 255 —Å–∏–º–≤–æ–ª–æ–≤
   - –û–±—Ä–µ–∑–∞–µ—Ç –¥–∏–∞–≥–Ω–æ–∑—ã –¥–æ 255/50 —Å–∏–º–≤–æ–ª–æ–≤
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤

4. **–û–±–Ω–æ–≤–ª—ë–Ω –º–µ—Ç–æ–¥ `sync_benefit_categories()`**
   - –û–±—Ä–µ–∑–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–æ 255 —Å–∏–º–≤–æ–ª–æ–≤
   - –û–±—Ä–µ–∑–∞–µ—Ç –∫–æ–¥—ã –¥–æ 50 —Å–∏–º–≤–æ–ª–æ–≤
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

5. **–û–±–Ω–æ–≤–ª—ë–Ω –º–µ—Ç–æ–¥ `sync_drug_supplies()`**
   - –û–±—Ä–µ–∑–∞–µ—Ç –∏–º–µ–Ω–∞ –≤—Ä–∞—á–µ–π –¥–æ 255 —Å–∏–º–≤–æ–ª–æ–≤
   - –û–±—Ä–µ–∑–∞–µ—Ç –Ω–æ–º–µ—Ä–∞ —Ä–µ—Ü–µ–ø—Ç–æ–≤ –¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤
   - –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã

```
======================================================================
–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ª—å–≥–æ—Ç–Ω–∏–∫–æ–≤ –∏–∑ —Ä–µ—Ü–µ–ø—Ç–æ–≤
======================================================================
üìã –ù–∞–π–¥–µ–Ω–æ —Ä–µ—Ü–µ–ø—Ç–æ–≤: 26259

üìÅ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ª—å–≥–æ—Ç...
  ‚úì –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: 46

üíä –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤...
  ‚ö†Ô∏è –û–±—Ä–µ–∑–∞–Ω–æ: –ê—Ü–µ—Ç–∏–ª—Å–∞–ª–∏—Ü–∏–ª–æ–≤–∞—è –∫–∏—Å–ª–æ—Ç–∞ + –ú–∞–≥–Ω–∏—è –≥–∏–¥—Ä–æ–∫—Å–∏–¥ + –ê... (–¥–ª–∏–Ω–∞: 287)
  ‚ö†Ô∏è –û–±—Ä–µ–∑–∞–Ω–æ: –ê–º–æ–∫—Å–∏—Ü–∏–ª–ª–∏–Ω + –ö–ª–∞–≤—É–ª–∞–Ω–æ–≤–∞—è –∫–∏—Å–ª–æ—Ç–∞ (–≤ —Ñ–æ—Ä–º–µ –∫... (–¥–ª–∏–Ω–∞: 312)
  ‚ö†Ô∏è –í—Å–µ–≥–æ –æ–±—Ä–µ–∑–∞–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–π: 45
  ‚úì –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤: 8234

üë• –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤...
  ‚úì –ü–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω–æ: 1523
  ‚úì –ü–∞—Ü–∏–µ–Ω—Ç–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–æ: 234

üìù –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π...
  ‚úì –ù–∞–∑–Ω–∞—á–µ–Ω–∏–π —Å–æ–∑–¥–∞–Ω–æ: 12456
  ‚úì –ù–∞–∑–Ω–∞—á–µ–Ω–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω–æ: 3421
  ‚ö†Ô∏è –û—à–∏–±–æ–∫: 12

======================================================================
‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
======================================================================
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–û–±—Ä–µ–∑–∞–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è**
   - –ü—Ä–µ–ø–∞—Ä–∞—Ç—ã —Å –¥–ª–∏–Ω–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –±—É–¥—É—Ç –æ–±—Ä–µ–∑–∞–Ω—ã –¥–æ 252 —Å–∏–º–≤–æ–ª–æ–≤ + "..."
   - –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –∏ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã
   - –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ Recipe

2. **–î—É–±–ª–∏–∫–∞—Ç—ã**
   - –ö–æ–º–∞–Ω–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `get_or_create()` - –Ω–µ —Å–æ–∑–¥–∞—Å—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
   - –ë–µ–∑–æ–ø–∞—Å–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑

3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
   - 26259 —Ä–µ—Ü–µ–ø—Ç–æ–≤ - –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 5-10 –º–∏–Ω—É—Ç
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--limit` –¥–ª—è —á–∞—Å—Ç–∏—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

4. **–û—à–∏–±–∫–∏**
   - –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç—É –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
   - –ü–µ—Ä–≤—ã–µ 5 –æ—à–∏–±–æ–∫ –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –≤ –≤—ã–≤–æ–¥–µ
   - –í—Å–µ –æ—à–∏–±–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ª–æ–≥

---

## üîÑ –ü–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ç—É—Å–æ–≤:

```bash
python manage.py update_beneficiaries_data --all
```

–≠—Ç–æ –æ–±–Ω–æ–≤–∏—Ç:
- –°—Ç–∞—Ç—É—Å—ã –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π (–∞–∫—Ç–∏–≤–Ω—ã–µ/–∏—Å—Ç–µ–∫—à–∏–µ)
- –ü–æ–º–µ—Ç–∏—Ç —Å—Ä–æ—á–Ω—ã–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
- –í—ã–≤–µ–¥–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

---

## üÜò –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

### –ö–æ–º–∞–Ω–¥–∞ —É–ø–∞–ª–∞ —Å –æ—à–∏–±–∫–æ–π
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥ Django
tail -f logs/django.log

# –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
python manage.py sync_from_recipes --limit 100 --verbosity 2
```

### –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –æ–±—Ä–µ–∑–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –ú–Ω–æ–≥–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ –≤ –†–æ—Å—Å–∏–∏ –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–µ. –ì–ª–∞–≤–Ω–æ–µ - –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –ø–∞–¥–∞–µ—Ç.

### –•–æ—á—É —É–≤–∏–¥–µ—Ç—å –∫–∞–∫–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –æ–±—Ä–µ–∑–∞—é—Ç—Å—è
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ dry-run —Ä–µ–∂–∏–º–µ - –ø–æ–∫–∞–∂–µ—Ç –ø–µ—Ä–≤—ã–µ 3 –ø—Ä–∏–º–µ—Ä–∞
python manage.py sync_from_recipes --limit 1000 --dry-run
```

### –ù—É–∂–Ω–æ –ø–µ—Ä–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å
–ö–æ–º–∞–Ω–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `get_or_create()` –∏ `update_or_create()`:
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- –ù–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã
- –ù–∏—á–µ–≥–æ –Ω–µ —É–¥–∞–ª–∏—Ç—Å—è

–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É —Å–Ω–æ–≤–∞:
```bash
python manage.py sync_from_recipes
```

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –õ–æ–≥–∏: `tail -f logs/django.log`
- –°—Ç–∞—Ç—É—Å –ë–î: `python manage.py dbshell`
- –í–µ—Ä—Å–∏—é –∫–æ–¥–∞: `git log -1`

