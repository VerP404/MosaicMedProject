{% extends "admin/change_list.html" %}
{% load i18n %}

{% block content %}
    {{ block.super }}

    <hr>
    <h2>Личный приём граждан руководителем МО за {{ selected_year }} год</h2>

    <form method="get" style="margin-bottom: 1em;">
        <label for="year">Выберите год:</label>
<select name="year" id="year">
    {% for y in distinct_years %}
        <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>{{ y }}</option>
    {% endfor %}
</select>

        <!-- Если нужны другие GET-параметры -->
        {% for k, v in request.GET.items %}
            {% if k != 'year' %}
                <input type="hidden" name="{{ k }}" value="{{ v }}">
            {% endif %}
        {% endfor %}
        <button type="submit">Показать</button>
    </form>

    <table border="1" cellspacing="0" cellpadding="5">
      <thead>
        <tr>
          <th rowspan="2">месяц</th>
          <th colspan="2">Количество</th>
          <th colspan="6">"Поддержано" (принятые меры)</th>
          <th rowspan="2">"поддержано без<br>принятия мер"</th>
          <th rowspan="2">"не поддержано"</th>
          <th rowspan="2">"разъяснено"</th>
          <th colspan="2">Ответ автору</th>
        </tr>
        <tr>
          <th>проведенных приемов</th>
          <th>принятых заявителей</th>
          <th>"поддержано, меры приняты"</th>
          <th>выговор</th>
          <th>замечание</th>
          <th>лишение<br>стимулирующих выплат</th>
          <th>совещание</th>
          <th>иное</th>
          <th>устный</th>
          <th>письменный</th>
        </tr>
      </thead>
      <tbody>
        {% for row in report_rows %}
        <tr>
          <td>{{ row.month_name }}</td>
          <td>{{ row.count_priyom }}</td>
          <td>{{ row.count_zayav }}</td>
          <td>{{ row.count_supported_measures }}</td>
          <td>{{ row.count_rebuke }}</td>
          <td>{{ row.count_comment }}</td>
          <td>{{ row.count_deprivation }}</td>
          <td>{{ row.count_meeting }}</td>
          <td>{{ row.count_other }}</td>
          <td>{{ row.count_supported_no_measures }}</td>
          <td>{{ row.count_not_supported }}</td>
          <td>{{ row.count_explained }}</td>
          <td>{{ row.count_oral_answer }}</td>
          <td>{{ row.count_written_answer }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

{% endblock %}
